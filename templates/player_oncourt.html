<!DOCTYPE html>
<html>
<head>

<title>Penn State Men's Volleyball Court Data</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<style>
    #category-buttons {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-bottom: 20px;
        padding: 10px;
        background-color: #f8f9fa;
        border: 1px solid #e0e0e0;
        border-radius: 8px;
        box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
    }

        #category-buttons button {
        background-color: #ffffff;
        color: #0c1c44;
        border: 1px solid #0c1c44;
        padding: 12px 20px;
        font-family: 'Roboto Condensed', sans-serif;
        font-size: 15px;
        font-weight: 500;
    }

    #weeks-content {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 20px;
    }

        .calendar-container {
            width: 80%;
            max-width: 600px;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            background: #f9f9f9;
            padding: 20px;
        }

        .calendar-header {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .week-box {
            display: flex;
            justify-content: center;
            align-items: center;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease-in-out;
        }

        .week-box:hover {
            background: #e0e7ff;
            transform: scale(1.05);
        }

        .week-box.selected {
            background: #4f46e5;
            color: #fff;
            border-color: #4f46e5;
        }

</style>
</head>
<body>
    <!-- HEADER -->
    <header>
        <div class="logo-container">
            <a href="/home">
                <img src="static/penn state pictures/psu_logo.png" alt="PSU Logo" class="logo">
            </a>
            <h1>Penn State Men's Volleyball</h1>
            <h1>—</h1>
            <h1>Individual On Court Performance</h1>
        </div>
        <nav>
            <ul class="tabs">
                <li class="dropdown-container">
                    <button>Team</button>
                    <ul class="dropdown-menu">
                        <li><a href="/team_strength">Strength and Conditioning</a></li>
                        <li><a href="/team_oncourt">On-Court Performance</a></li>
                    </ul>
                </li>
                <li class="dropdown-container">
                    <button>Individual</button>
                    <ul class="dropdown-menu">
                        <li><a href="/player_strength">Strength and Conditioning</a></li>
                        <li><a href="/player_oncourt">On-Court Performance</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
    </header>

    <!-- MAIN CONTENT -->
    <div class="main-container">

        <aside class="sidebar">

            <div class="player-profile" id="player-profile">

                <div class="player-select">
                    <select id="player-selector" onchange="updatePlayerProfile()"></select> <!-- CURRENTLY HIDDEN -->
                </div>
                
            </div>

           

            <!-- Practices Section -->
        <div id="practices" class="section" onclick="toggleSection('practices')">Practices</div>
        <div id="practices-content" class="content">
            <div class="navigation-buttons">
                <button onclick="previousWeek()">Previous Week</button>
                <button onclick="nextWeek()">Next Week</button>
            </div>
            <div class="practice-blocks" id="practiceBlocks">
                <!-- Days dynamically generated by JavaScript -->
            </div>
            
        </div>

            <!-- Weeks Section -->
        <div id="weeks" class="section" onclick="toggleSection('weeks')">Weeks</div>
        <div id="weeks-content" class="content">
            <div class="calendar-container">
                <div class="calendar-header">
                    <span>Select a Week</span>
                </div>
                <div class="calendar-grid">
                    <!-- Dynamic week boxes will be generated here -->
                </div>
            </div>
        </div>
        

        <!-- Months Section -->
        <div id="months" class="section" onclick="toggleSection('months')">Months</div>
        <div id="months-content" class="content">
            <div class="months-table">
                <div class="month-box">Month 1 | Sept.</div>
                <div class="month-box">Month 2 | Oct.</div>
                <div class="month-box">Month 3 | Nov.</div>
                <div class="month-box">Month 4 | Dec.</div>
            </div>
        </div>



        <!-- All Time Button -->
        <div class="section" onclick="resetSections()">All Time</div>
    </aside>

        <!-- MAIN DASHBOARD AREA -->
        <main class="dashboard">
            <!-- Category Buttons -->
            <div id="category-buttons">
                <button onclick="showStats('setting')">Set</button>
                <button onclick="showStats('attacking')">Attack</button>
                <button onclick="showStats('serving')">Serve</button>
                <button onclick="showStats('passing')">Pass</button>
            </div>

            <!-- Selected Time Periods Section -->
            <div id="selected-practices-container">
                <h2>Selected Time Periods</h2>
                <ul id="selected-practices-list">
                    <!-- Dynamically populated -->
                </ul>
            </div>

            <!-- Stats Content -->
            <div id="stats-container">
                <p>Select a category above to view stats.</p>
            </div>
        </main>
    </div>

    <footer>
        <p>© 2024 Penn State Men's Volleyball</p>
    </footer>

    <script>
        const buttons = document.querySelectorAll('#category-buttons button');

        buttons.forEach(button => {
            button.addEventListener('click', () => {
                // Remove active class from all buttons
                buttons.forEach(btn => btn.classList.remove('active'));
                
                // Add active class to the clicked button
                button.classList.add('active');
            });
        });

        // Load player data from the players.json file
        fetch('static/player_data/players.json')
        .then(response => response.json())
        .then(players => {
            const playerSelector = document.getElementById('player-selector');
            players.forEach(player => {
                const option = document.createElement('option');
                option.value = player.name;
                option.textContent = player.name;
                playerSelector.appendChild(option);
            });
            
            updatePlayerProfile(players[0]);

        })
        .catch(error => {
            console.error('Error loading player data:', error);
        });


        function showStats(category) {
            const statsContainer = document.getElementById('stats-container');

            let statsContent = `<p>Select a category above to view stats.</p>`; // Default content

            if (category === "setting") {
                statsContent = `<p>Displaying setting stats...</p>`;
            } else if (category === "attacking") {
                statsContent = `<p>Displaying attacking stats...</p>`;
            } else if (category === "serving") {
                statsContent = `<p>Displaying serving stats...</p>`;
            } else if (category === "passing") {
                statsContent = `<p>Displaying passing stats...</p>`;
            }

            statsContainer.innerHTML = statsContent;
        }

        // Update player profile based on selection
        function updatePlayerProfile() {
            const selectedPlayerName = document.getElementById('player-selector').value;
            
            fetch('static/player_data/players.json')
                .then(response => response.json())
                .then(players => {
                    const player = players.find(p => p.name === selectedPlayerName);

                    const profile = document.getElementById('player-profile');
                    profile.innerHTML = `
                        <img src="${player.headshot}" alt="Player Headshot" class="headshot">
                        <h2>${player.name}</h2>
                        <p>#${player.jersey_number} - ${player.position}   |   ${player.class}</p>`;
                });
        }
        
       const startDate = new Date("2024-09-23"); // Monday, September 23rd
        const endDate = new Date("2024-12-13");   // Friday, December 13th
        const days = ["Mon", "Tue", "Wed", "Th", "Fr"];
        let currentWeekStart = new Date(startDate);

        function renderPractices() {
            const practiceBlocks = document.getElementById("practiceBlocks");
            practiceBlocks.innerHTML = ""; // Clear previous blocks

            for (let i = 0; i < 5; i++) { // 5 weekdays
                const practiceDate = new Date(currentWeekStart);
                practiceDate.setDate(currentWeekStart.getDate() + i);

                // Only render dates within the valid range
                if (practiceDate > endDate) break;

                const block = document.createElement("div");
                block.className = "practice-block";
                block.innerHTML = `
                    ${days[i]} 
                    <div class="practice-date">${formatDate(practiceDate)}</div>
                `;
                practiceBlocks.appendChild(block);
            }
        }

        function formatDate(date) {
            const month = date.getMonth() + 1; // Months are zero-indexed
            const day = date.getDate();
            return `${month}/${day}`;
        }

        function nextWeek() {
            const nextWeekStart = new Date(currentWeekStart);
            nextWeekStart.setDate(currentWeekStart.getDate() + 7);

            if (nextWeekStart <= endDate) {
                currentWeekStart = nextWeekStart;
                renderPractices();
            }
        }

        function previousWeek() {
            const prevWeekStart = new Date(currentWeekStart);
            prevWeekStart.setDate(currentWeekStart.getDate() - 7);

            if (prevWeekStart >= startDate) {
                currentWeekStart = prevWeekStart;
                renderPractices();
            }
        }

        function toggleSection(activeSection) {
    const content = document.getElementById(`${activeSection}-content`);
    const section = document.getElementById(activeSection);

    // Check if the section is already visible
    if (content.style.display === 'block') {
        // Hide the section
        resetSections();
    } else {
        // Hide all other sections
        document.querySelectorAll('.content').forEach(content => content.style.display = 'none');
        document.querySelectorAll('.section').forEach(section => section.classList.add('inactive'));

        // Show the selected section
        content.style.display = 'block';
        section.classList.remove('inactive');
    }
}


        function resetSections() {
            document.querySelectorAll('.content').forEach(content => content.style.display = 'none');
            document.querySelectorAll('.section').forEach(section => section.classList.remove('inactive'));
        }

        // Initial render for practices
        renderPractices();

        function setupDropdown(selectedContainerId, dropdownId) {
            const selectedContainer = document.getElementById(selectedContainerId);
            const dropdown = document.getElementById(dropdownId);

            // Show dropdown when the selected area is clicked
            selectedContainer.addEventListener('click', () => {
                dropdown.style.display = 'block';
            });

            // Hide dropdown if clicked outside
            document.addEventListener('click', (event) => {
                if (!selectedContainer.contains(event.target) && !dropdown.contains(event.target)) {
                    dropdown.style.display = 'none';
                }
            });
        }

        let selectedPractices = []; // Array to track selected practices
        let selectedWeeks = []; // Array to track selected weeks
        let selectedMonths = []; // Array to track selected months;

        // Render practices for the current week
        function renderPractices() {
            const practiceBlocks = document.getElementById("practiceBlocks");
            practiceBlocks.innerHTML = ""; // Clear previous blocks

            for (let i = 0; i < 5; i++) { // 5 weekdays
                const practiceDate = new Date(currentWeekStart);
                practiceDate.setDate(currentWeekStart.getDate() + i);

                // Only render dates within the valid range
                if (practiceDate > endDate) break;

                const block = document.createElement("div");
                block.className = "practice-block";
                block.textContent = `${days[i]} (${formatDate(practiceDate)})`;
                block.onclick = () => togglePracticeSelection(formatDate(practiceDate));
                practiceBlocks.appendChild(block);
            }
        }

        // Toggle practice selection
        function togglePracticeSelection(date) {
            if (selectedPractices.includes(date)) {
                selectedPractices = selectedPractices.filter(practice => practice !== date);
            } else {
                selectedPractices.push(date);
            }
            updateSelectedTimePeriods();
        }

        // Toggle week selection
        function toggleWeekSelection(weekBox, weekRange) {
            // Toggle 'selected' class on the clicked week
            weekBox.classList.toggle("selected");

            if (weekBox.classList.contains("selected")) {
                // Add weekRange to selectedWeeks if it's not already there
                if (!selectedWeeks.includes(weekRange)) {
                    selectedWeeks.push(weekRange);
                }
            } else {
                // Remove weekRange from selectedWeeks if it exists
                const index = selectedWeeks.indexOf(weekRange);
                if (index > -1) {
                    selectedWeeks.splice(index, 1);
                }
            }

            console.log("Current Selected Weeks:", selectedWeeks);
            updateSelectedTimePeriods(); // Update the list after each change
        }

        // Toggle month selection
        function toggleMonthSelection(monthName) {
            if (selectedMonths.includes(monthName)) {
                selectedMonths = selectedMonths.filter(month => month !== monthName);
            } else {
                selectedMonths.push(monthName);
            }
            updateSelectedTimePeriods();
        }

        // Update the "Selected Time Periods" list
        function updateSelectedTimePeriods() {
            const selectedList = document.getElementById("selected-practices-list");
            selectedList.innerHTML = ""; // Clear previous list

            const categories = [
                { title: "Selected Practices", items: selectedPractices },
                { title: "Selected Weeks", items: selectedWeeks },
                { title: "Selected Months", items: selectedMonths },
            ];

            categories.forEach(category => {
                if (category.items && category.items.length > 0) {
                    // Add a category header
                    const categoryHeader = document.createElement("li");
                    categoryHeader.textContent = category.title;
                    categoryHeader.style.fontWeight = "bold"; // Optional: Style for clarity
                    categoryHeader.style.marginTop = "10px"; // Spacing
                    selectedList.appendChild(categoryHeader);

                    // Add items under the category
                    category.items.forEach(item => {
                        const listItem = document.createElement("li");
                        listItem.textContent = item;
                        selectedList.appendChild(listItem);
                    });
                } else {
                    console.log(`No items found for ${category.title}`);
                }
            });
        }

        // Render weeks with date ranges
        function renderWeeks() {
            const calendarGrid = document.querySelector(".calendar-grid");
            calendarGrid.innerHTML = ""; // Clear previous content

            let weekIndex = 1; // Start week count
            while (currentWeekStart <= endDate) {
                const weekStart = new Date(currentWeekStart);
                const weekEnd = new Date(weekStart);
                weekEnd.setDate(weekStart.getDate() + 4); // Friday of the same week

                const weekRange = `${formatDate(weekStart)} - ${formatDate(weekEnd)}`;
                const weekBox = document.createElement("div");

                weekBox.className = "week-box";
                weekBox.textContent = `Week ${weekIndex}`;
                weekBox.title = `${days[0]} ${formatDate(weekStart)} to ${days[4]} ${formatDate(weekEnd)}`;

                weekBox.onclick = () => toggleWeekSelection(weekBox, weekRange);

                calendarGrid.appendChild(weekBox);

                currentWeekStart.setDate(currentWeekStart.getDate() + 7); // Move to next Monday
                weekIndex++;
            }
        }

        // Render months by name
        function renderMonths() {
            const monthsTable = document.querySelector(".months-table");

            const months = [
                { name: "September", start: "2024-09-01", end: "2024-09-30" },
                { name: "October", start: "2024-10-01", end: "2024-10-31" },
                { name: "November", start: "2024-11-01", end: "2024-11-30" },
                { name: "December", start: "2024-12-01", end: "2024-12-31" },
            ];

            monthsTable.innerHTML = ""; // Clear table
            months.forEach(month => {
                const monthBox = document.createElement("div");
                monthBox.className = "month-box";
                monthBox.textContent = `${month.name}`;
                monthBox.onclick = () => toggleMonthSelection(month.name);

                monthsTable.appendChild(monthBox);
            });
        }

        // Format date to MM/DD
        function formatDate(date) {
            const month = date.getMonth() + 1; // Months are zero-indexed
            const day = date.getDate();
            return `${month}/${day}`;
        }

        // Initialize default renders
        renderPractices();
        renderWeeks();
        renderMonths();

        // Initialize dropdown and filters on page load
        window.onload = () => {
            populateDropdown('practiceDropdown', practiceData); // Populate dropdown with practice data
            setupDropdown('selectedPractices', 'practiceDropdown'); // Setup dropdown interaction
        };


    </script>
</body>
</html>